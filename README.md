# Smoking_detection

[Здесь](https://drive.google.com/drive/folders/1JJa26S6yv5HhkkQFsRBJXRzgnt2vwFew?usp=sharing) можно посмотреть все исходники:
- **ResNet50.ipynb** — файл со всем исходным кодом.
- **X_multyclass.npy** и **y_multyclass.npy** — файлы с предобработанными изображениями.
- **resnet50_*.h5** — обученные модели.

## Постановка задачи
В рамках хакатона от OZON TECH необходимо было создать модель для определения акта курения на изображениях товаров. Был предоставлен датасет, размеченный на 5 классов:
- **cigs** — изображения с сигаретами,
- **pipes** — изображения с курительными трубками,
- **roll_cigs** — изображения с самокрутками,
- **smoking** — изображения курящих людей,
- **other** — изображения без демонстрации и употребления табачной продукции.

На основе этого датасета предлагается обучить модель машинного обучения с целевой метрикой F1-score.

## Формирование X_multyclass.npy и y_multyclass.npy
На основе исходного датасета были сформированы два numpy массива: **X_multyclass.npy** и **y_multyclass.npy**.

В **X_multyclass.npy** содержатся трехмерные numpy массивы размера (224, 224, 3), полученные из исходных изображений при помощи инструментов библиотеки cv2.

В **y_multyclass.npy** хранится one-hot-encoding представление класса, которому принадлежит соответствующее изображение из **X_multyclass.npy** (other, cigs, pipes, roll_cigs, smoking).

## Построение модели многоклассовой классификации
Используем подход Transfer Learning: предобученную на ImageNet модель ResNet50. Заморозим веса в слоях сверток и будем получать от нее некоторое embedding-представление, которое локализуем под нашу задачу многоклассовой классификации. Модель обучена распознавать пять классов и интерпретировать результат в нужное нам пространство.

Таким образом, получена модель **resnet50_multyclass_model2+3+4epoch.h5**, её F1-score на тестовой выборке составляет 0.93.

## Построение модели бинарной классификации
Аналогично предыдущему пункту, используется предобученная модель ResNet50 как backbone, после чего дообучаются последние слои сети на наших данных.
Получена модель **resnet50_binary_model4epoch.h5** с F1-score на тесте также равным 0.93.

## Выводы
В рамках задачи была разработана система на основе ResNet50, способная эффективно распознавать и классифицировать изображения с присутствием табачной продукции. В результате выполнения двух подходов — многоклассовой и бинарной классификаций — удалось достичь высокой точности:

- Модель многоклассовой классификации успешно классифицирует изображения по 5 классам: сигареты, курительные трубки, самокрутки, курящие люди и изображения без табачной продукции. Полученное значение метрики F1-score на тестовой выборке составило 0.93, что указывает на высокий уровень точности модели при работе с разнородными изображениями.

- Модель бинарной классификации была обучена для распознавания табачной продукции в целом, разделяя изображения на два класса: табак и отсутствие табака. Эта модель также достигла значения F1-score 0.93 на тестовой выборке, что подтверждает её эффективность и возможность применения для детекции табачных изделий на изображениях.

Обе модели продемонстрировали высокую точность и стабильные результаты на тестовой выборке, что указывает на их потенциал для использования в автоматизированных системах анализа изображений, например, для модерации контента или фильтрации нежелательной продукции.
